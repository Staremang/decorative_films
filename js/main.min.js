"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function removeSelect(){document.querySelector(".film-list-select").removeChild(this.parentElement)}function addSelect(){document.querySelectorAll(".form-popup__select-add").forEach(function(t,e){t.removeEventListener("click",addSelect),t.classList.remove("form-popup__select-add"),t.classList.add("form-popup__select-remove"),t.innerHTML="–",t.title="Удалить наименование",t.addEventListener("click",removeSelect)});var i="";type.forEach(function(t,e){i+='<optgroup label="'+t.name+'">',t.sub.forEach(function(t,e){i+="<option value=”"+t.id+"”>"+t.name+"</option>"}),i+="</optgroup>"});var t=document.createElement("div"),e=document.createElement("select"),o=document.createElement("input"),n=document.createElement("button");t.className="form-popup__select-item",e.name="",e.className="form-popup__select",e.innerHTML=i,o.className="input form-popup__select-input",o.name="",o.type="number",o.placeholder="Размер, м",n.type="button",n.className="btn form-popup__select-add",n.innerHTML="+",n.title="Добавить наименование",n.addEventListener("click",addSelect),t.appendChild(e),t.appendChild(o),t.appendChild(n),document.querySelector(".film-list-select").appendChild(t)}var _createClass=function(){function o(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(s){window.anchor={settings:{transitionDuration:2e3,transitionTimingFunction:"swing",labels:{error:"Couldn't find any section"}},init:function(t){return s(this).data("settings",s.extend(anchor.settings,t)),this.each(function(){var e=s(this);e.unbind("click").click(function(t){t.preventDefault(),anchor.jumpTo(anchor.getTopOffsetPosition(e),e.data("settings"))})})},getTopOffsetPosition:function(t){var e=t.attr("href"),i=s(s(e).get(0)),o=s(document).height(),n=s(window).height();if(!i||i.length<1)throw new ReferenceError(anchor.settings.labels.error);return i.offset().top+n>o?o-n:i.offset().top},jumpTo:function(t,e){var i=s("html, body");i.animate({scrollTop:t-50},e.transitionDuration,e.transitionTimingFunction),i.bind("scroll mousedown DOMMouseScroll mousewheel keyup",function(t){(0<t.which||"mousedown"===t.type||"mousewheel"===t.type)&&i.stop().unbind("scroll mousedown DOMMouseScroll mousewheel keyup")})}},s.fn.anchor=function(t){return anchor[t]?anchor[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==(void 0===t?"undefined":_typeof(t))&&t?s.error("Method "+t+" does not exist on jQuery.anchor"):anchor.init.apply(this,arguments)}}(jQuery);var Popup=function(){function t(){_classCallCheck(this,t),this.$block=$(".popup"),this.generated=!1,this.lastDescription=""}return _createClass(t,[{key:"open",value:function(t){this.generated||this.generate(),this.switch(t)}},{key:"switch",value:function(i){var o,n;$(".films-menu__title").removeClass("active"),$(".films-menu__subtitle").removeClass("active"),$(".films-preview__color").removeClass("active"),$(".films-preview__colors-list").removeClass("active"),$('.films-menu__subtitle[data-src="'+i+'"]').addClass("active").parents(".films-menu__title").addClass("active"),$('.films-preview__color[data-src="'+i+'"]').addClass("active").parent().addClass("active"),type.some(function(t,e){return(o=t).sub.some(function(t,e){return i===(n=t).id})}),$(".films-description__title").text(o.name),$(".films-description__subtitle").text(n.name),$(".films-gallery").empty(),n.galleryPrev&&n.galleryPrev.forEach(function(t){$(".films-gallery").append('<a class="films-gallery__item" data-fancybox="gallery" href="'+t[0]+'"><img src="'+t[1]+'"></a>')});var t=n.content||o.content,s='<div data-tooltip="<table><tr><th>Количество</th><th>Стоимость</th></tr><tr><td>от 1 до 10 метров</td><td>'+t.price[1]+" руб./м.п.</td></tr><tr><td>свыше 10 метров</td><td>"+t.price[2]+" руб./м.п.</td></tr><tr><td>кратно рулону</td><td>"+t.price[3]+' руб./м.п.</td></tr></table>">\t\t\t\t\t<div class="films-description__price">от '+t.price[0]+'** RUB за 1м<sup>2</sup></div>\t\t\t\t\t<div class="films-description__price-note">** стоимость указана при приобретении рулона</div>\t\t\t\t</div>';t.description.forEach(function(t,e){void 0!==t.tooltip?s+='<div class="films-description__text" data-tooltip="'+t.tooltip+'">'+t.text+"</div>":s+='<div class="films-description__text">'+t.text+"</div>"}),s+='<div class="films-description__prop-title">Характеристики / Свойства:</div>',s+='<ul class="films-description__properties">',t.properties.forEach(function(t,e){void 0!==t.tooltip?s+='<li class="films-description__properties-item '+t.iconClass+'" data-tooltip="'+t.tooltip+'">'+t.text+"</li>":s+='<li class="films-description__properties-item '+t.iconClass+'">'+t.text+"</li>"}),s+="</ul>",void 0!==t.proportions.tooltip?s+='<div data-tooltip="'+t.proportions.tooltip+'">':s+="<div>",s+='<ul class="properties-border">\t\t\t\t\t<li class="properties-border__item">Размер рулона: <span class="properties-border__val">1220mm х 50m</span></li>\t\t\t\t\t<li class="properties-border__item">Основа: <span class="properties-border__val">PVC 100μm + glue 20μm</span> (clear)</li>\t\t\t\t\t<li class="properties-border__item">Подложка: <span class="properties-border__val">SiliconPaper 120g/m<sup>2</sup></span></li>\t\t\t\t</ul>\t\t\t</div>\t\t\t<ul class="films-description__properties">\t\t\t\t<li class="films-description__properties-item icon-tovar-min">Продается только погонажем. <br>Минимальный заказ - 1 пог. метр.</li>\t\t\t</ul>',$(".films-description__content").html(s),$("[data-tooltip]").tooltip()}},{key:"generate",value:function(){var i="",o="",t=this;type.forEach(function(t,e){i+='<li class="films-menu__title">\n',i+='<span class="films-menu__title-link">'+t.name+"</span>",i+='<ul class="films-menu__subtitle-block">',o+='<div class="films-preview__colors-list">',t.sub.forEach(function(t,e){i+='<li class="films-menu__subtitle" data-popup-in data-src="'+t.id+'">'+t.name+"</li>",o+='<div class="films-preview__color" data-popup-in data-src="'+t.id+'"><img src="'+t.prevUrl+'" alt="'+t.name+'"></div>'}),i+="</ul>",i+="</li>",o+="</div>"}),i+='<li>\t\t\t\t\t<button type="button" data-fancybox data-src="#payment_and_shiping" class="btn films-menu__btn">Оплата и доставка</button>\t\t\t\t</li>',i+='<button type="button" data-fancybox data-src="#order" class="btn films-menu__btn">Оформить заказ</button>',t.$block.find(".films-menu").html(i),t.$block.find(".films-preview__colors-container").html(o),$(".films-menu__title-link").click(function(){$(".films-menu__title").removeClass("active"),$(this).parent().addClass("active")}),$("[data-popup-in]").click(function(){t.switch($(this).data("src"))}),t.generated=!0}}]),t}();$.fn.tooltip=function(){var t="";$(this).each(function(){""!=$(this).data("tooltip")&&0==$(this).children(".tooltip").length&&(t='<div class="tooltip">\t\t\t\t\t<div class="tooltip__icon">*</div>\t\t\t\t\t<div class="tooltip__content">'+$(this).data("tooltip")+"</div>\t\t\t\t</div>",$(this).removeAttr("data-tooltip"),$(this).prepend(t))})},$(document).ready(function(){$("[data-fancybox]").fancybox({transitionEffect:"slide"}),$(".section__list-item").click(function(){var t=$(this).parents(".section");t.find(".section__bg").removeClass("active"),t.find(".section__bg").eq($(this).data("bg")).addClass("active")});var t=new Popup;$("[data-film-id]").click(function(){t.open($(this).data("film-id"))}),$("[data-tooltip]").tooltip(),addSelect()});