"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function removeSelect(){document.querySelector(".film-list-select").removeChild(this.parentElement)}function addSelect(){document.querySelectorAll(".form-popup__select-add").forEach(function(t,e){t.removeEventListener("click",addSelect),t.classList.remove("form-popup__select-add"),t.classList.add("form-popup__select-remove"),t.innerHTML="–",t.title="Удалить наименование",t.addEventListener("click",removeSelect)});var i="";type.forEach(function(t,e){i+='<optgroup label="'+t.id+'">',t.sub.forEach(function(t,e){i+="<option value=”"+t.id+"”>"+t.name+"</option>"}),i+="</optgroup>"});var t=document.createElement("div"),e=document.createElement("select"),n=document.createElement("input"),o=document.createElement("button");t.className="form-popup__select-item",e.name="",e.className="form-popup__select",e.innerHTML=i,n.className="input form-popup__select-input",n.name="",n.type="number",n.placeholder="Размер, м",o.type="button",o.className="btn form-popup__select-add",o.innerHTML="+",o.title="Добавить наименование",o.addEventListener("click",addSelect),t.appendChild(e),t.appendChild(n),t.appendChild(o),document.querySelector(".film-list-select").appendChild(t)}var _createClass=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(s){window.anchor={settings:{transitionDuration:2e3,transitionTimingFunction:"swing",labels:{error:"Couldn't find any section"}},init:function(t){return s(this).data("settings",s.extend(anchor.settings,t)),this.each(function(){var e=s(this);e.unbind("click").click(function(t){t.preventDefault(),anchor.jumpTo(anchor.getTopOffsetPosition(e),e.data("settings"))})})},getTopOffsetPosition:function(t){var e=t.attr("href"),i=s(s(e).get(0)),n=s(document).height(),o=s(window).height();if(!i||i.length<1)throw new ReferenceError(anchor.settings.labels.error);return i.offset().top+o>n?n-o:i.offset().top},jumpTo:function(t,e){var i=s("html, body");i.animate({scrollTop:t-50},e.transitionDuration,e.transitionTimingFunction),i.bind("scroll mousedown DOMMouseScroll mousewheel keyup",function(t){(0<t.which||"mousedown"===t.type||"mousewheel"===t.type)&&i.stop().unbind("scroll mousedown DOMMouseScroll mousewheel keyup")})}},s.fn.anchor=function(t){return anchor[t]?anchor[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==(void 0===t?"undefined":_typeof(t))&&t?s.error("Method "+t+" does not exist on jQuery.anchor"):anchor.init.apply(this,arguments)}}(jQuery);var Popup=function(){function t(){_classCallCheck(this,t),this.$block=$(".popup"),this.generated=!1,this.lastDescription=""}return _createClass(t,[{key:"open",value:function(t){this.generated||this.generate(),this.switch(t)}},{key:"switch",value:function(i){var n,o;$(".films-menu__title").removeClass("active"),$(".films-menu__subtitle").removeClass("active"),$(".films-preview__color").removeClass("active"),$(".films-preview__colors-list").removeClass("active"),$('.films-menu__subtitle[data-src="'+i+'"]').addClass("active").parents(".films-menu__title").addClass("active"),$('.films-preview__color[data-src="'+i+'"]').addClass("active").parent().addClass("active"),type.some(function(t,e){return(n=t).sub.some(function(t,e){return i===(o=t).id})}),$(".films-description__title").text(n.name),$(".films-description__subtitle").text(o.name),$(".films-gallery").empty(),o.galleryPrev&&o.galleryPrev.forEach(function(t){$(".films-gallery").append('<a class="films-gallery__item" data-fancybox="gallery" href="'+t[0]+'"><img src="'+t[1]+'"></a>')}),(o.description||n.description)!==this.lastDescription&&(this.lastDescription=o.description||n.description,$(".films-description__content").html(o.description||n.description),$("[data-tooltip]").tooltip())}},{key:"generate",value:function(){var i="",n="",t=this;type.forEach(function(t,e){i+='<li class="films-menu__title">\n',i+='<span class="films-menu__title-link">'+t.name+"</span>",i+='<ul class="films-menu__subtitle-block">',n+='<div class="films-preview__colors-list">',t.sub.forEach(function(t,e){i+='<li class="films-menu__subtitle" data-popup-in data-src="'+t.id+'">'+t.name+"</li>",n+='<div class="films-preview__color" data-popup-in data-src="'+t.id+'"><img src="'+t.prevUrl+'" alt="'+t.name+'"></div>'}),i+="</ul>",i+="</li>",n+="</div>"}),i+='<li>\t\t\t\t\t<button type="button" data-fancybox data-src="#payment_and_shiping" class="btn films-menu__btn">Оплата и доставка</button>\t\t\t\t</li>',i+='<button type="button" data-fancybox data-src="#order" class="btn films-menu__btn">Оформить заказ</button>',t.$block.find(".films-menu").html(i),t.$block.find(".films-preview__colors-container").html(n),$(".films-menu__title-link").click(function(){$(".films-menu__title").removeClass("active"),$(this).parent().addClass("active")}),$("[data-popup-in]").click(function(){t.switch($(this).data("src"))}),t.generated=!0}}]),t}();$.fn.tooltip=function(){var t="";$(this).each(function(){""!=$(this).data("tooltip")&&0==$(this).children(".tooltip").length&&(t='<div class="tooltip">\t\t\t\t\t<div class="tooltip__icon"></div>\t\t\t\t\t<div class="tooltip__content">'+$(this).data("tooltip")+"</div>\t\t\t\t</div>",$(this).removeAttr("data-tooltip"),$(this).prepend(t))})},$(document).ready(function(){$("[data-fancybox]").fancybox({transitionEffect:"slide"}),$(".section__list-item").click(function(){var t=$(this).parents(".section");t.find(".section__bg").removeClass("active"),t.find(".section__bg").eq($(this).data("bg")).addClass("active")});var t=new Popup;$("[data-film-id]").click(function(){t.open($(this).data("film-id"))}),$("[data-tooltip]").tooltip(),addSelect()});